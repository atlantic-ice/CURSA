# Функциональная модель IDEF0: модуль конфигураций стандартов нормоконтроля CURSA

Дата: 30.09.2025

Цель модели: описать функции и взаимодействия модуля конфигураций стандартов (ГОСТ и локальные требования вузов) в составе программного продукта CURSA.

Точка зрения: методист/администратор нормоконтроля, сопровождающий правила и профили вузов.

Контекст: модуль предоставляет интерфейсы для создания, валидации, версионирования и публикации конфигураций стандартов, которые далее потребляет проверочное ядро (NormControlChecker) при анализе документов.

---

## A-0 Контекстная диаграмма

Диаграмма отражает систему как единый функциональный блок с типами дуг IDEF0: вход (Input), управление (Control), механизм (Mechanism), выход (Output).

```mermaid
flowchart LR
    %% Группы по типам дуг IDEF0
    subgraph IN[Входы (Input)]
        IN1[Внешние нормативы: ГОСТ, локальные регламенты]
        IN2[Заявки/требования профилей вузов]
    end

    subgraph CTL[Управление (Control)]
        C1[Методология нормоконтроля, регламенты и роли доступа]
        C2[Политики версионирования и публикации]
    end

    subgraph MEC[Механизмы (Mechanism)]
        M1[Администратор/методист]
        M2[CURSA Backend + Web‑интерфейс]
        M3[Хранилище конфигураций (JSON/БД)]
    end

    A0["A-0 Управление конфигурациями стандартов нормоконтроля"]

    subgraph OUT[Выходы (Output)]
        O1[Опубликованные наборы норм для NormControlChecker]
        O2[Архив версий и журнал изменений]
        O3[Экспорт/импорт пакетов правил (JSON/CSV)]
        O4[API-доступ к актуальным конфигурациям]
    end

    %% Входы
    IN1 --> A0
    IN2 --> A0

    %% Управление (пунктир)
    C1 -.-> A0
    C2 -.-> A0

    %% Механизмы
    M1 --> A0
    M2 --> A0
    M3 --> A0

    %% Выходы
    A0 --> O1
    A0 --> O2
    A0 --> O3
    A0 --> O4
```

Краткое описание A-0: на основании входов (нормативы и требования профилей) при управлении регламентами и ролями, с использованием механизмов (администратор, программная платформа и хранилище) формируются опубликованные конфигурации стандартов, доступные через API и в виде экспортируемых пакетов; ведётся журнал изменений и архив версий.

---

## A0 Декомпозиция на блоки

Диаграмма A0 раскрывает контекстный блок на функции A1–A6. Внутренние стрелки показывают основные информационные потоки между работами.

```mermaid
flowchart LR
    %% Вспомогательные группы I/C/M/O
    subgraph INP[Входы]
        i1[ГОСТ и локальные нормативы]
        i2[Требования профилей вузов]
    end

    subgraph CTRL[Управление]
        c1[Регламенты разработки правил, роли доступа]
        c2[Политика версионирования и публикации]
    end

    subgraph MECH[Механизмы]
        m1[Администратор/методист]
        m2[CURSA Backend + UI]
        m3[Хранилище конфигураций]
    end

    A1["A1 Сбор и импорт нормативов"]
    A2["A2 Проектирование модели данных и словаря правил"]
    A3["A3 Конфигурирование профилей и пресетов стандартов"]
    A4["A4 Валидация и согласование изменений"]
    A5["A5 Версионирование и публикация конфигураций"]
    A6["A6 Экспорт/импорт, резервное копирование и миграции"]

    subgraph OUTS[Выходы]
        o1[Опубликованные конфигурации для проверки]
        o2[Журнал/аудит и архив версий]
        o3[Пакеты экспорта (JSON/CSV)]
    end

    %% Общие входы и управление
    i1 --> A1
    i2 --> A3
    c1 -.-> A1
    c1 -.-> A2
    c1 -.-> A3
    c1 -.-> A4
    c2 -.-> A5

    %% Механизмы
    m1 --> A1
    m1 --> A3
    m1 --> A4
    m2 --> A1
    m2 --> A2
    m2 --> A3
    m2 --> A4
    m2 --> A5
    m2 --> A6
    m3 --> A5
    m3 --> A6

    %% Внутренние потоки
    A1 -- "Нормативные элементы" --> A2
    A2 -- "Модель правил, словарь сущностей" --> A3
    A3 -- "Проекты конфигураций" --> A4
    A4 -- "Проверенные/согласованные конфигурации" --> A5
    A5 -- "Активные версии" --> o1
    A5 -- "История/теги версий" --> o2
    A6 -- "Экспортные пакеты и бэкапы" --> o3

    %% Обращения к хранилищу
    A5 -->|Запись стабильной версии| m3
    A6 -->|Резервное копирование/восстановление| m3
```

---

## Текстовое описание работ A1–A6

Ниже для каждой функции приведены типы дуг IDEF0 и краткие обязанности.

### A1 Сбор и импорт нормативов
- Вход: ГОСТ, локальные регламенты, методические материалы.
- Управление: регламенты разработки правил, требования к трассировке источников.
- Механизмы: администратор/методист, UI, парсеры/импортёры.
- Выход: каталог нормативных элементов (правила, параметры, ссылки на источники).

### A2 Проектирование модели данных и словаря правил
- Вход: каталог нормативных элементов из A1.
- Управление: модель данных CURSA, соглашения имен, типизация параметров.
- Механизмы: backend‑сервисы, редактор схем, валидаторы.
- Выход: формальная модель правил, словарь сущностей и атрибутов.

### A3 Конфигурирование профилей и пресетов стандартов
- Вход: модель правил/словарь (A2), требования профилей вузов.
- Управление: матрица применимости, приоритеты и допускаемые отклонения.
- Механизмы: UI конфигурирования, роли доступа.
- Выход: проекты конфигураций (профили/пресеты) для согласования.

### A4 Валидация и согласование изменений
- Вход: проекты конфигураций из A3.
- Управление: правила целостности, процедуры согласования, журналы ревью.
- Механизмы: валидаторы, чек-листы, участники согласования.
- Выход: проверенные и согласованные конфигурации.

### A5 Версионирование и публикация конфигураций
- Вход: согласованные конфигурации из A4.
- Управление: политика версионирования (семантическая), регламент публикации.
- Механизмы: репозиторий/БД, сервис публикации, CI‑скрипты (опционально).
- Выход: активные версии конфигураций для NormControlChecker; журнал/архив версий.

### A6 Экспорт/импорт, резервное копирование и миграции
- Вход: активные и черновые конфигурации из хранилища.
- Управление: политика резервного копирования, формат обмена данными.
- Механизмы: инструменты экспорта/импорта, подсистема бэкапов.
- Выход: пакеты экспорта (JSON/CSV), резервные копии, отчёты о миграциях.

---

## Примечания по оформлению отчёта

- Все рисунки и подписи находятся в одном файле; при печати рекомендуется экспорт диаграмм в SVG/PNG и вставка в текст пояснительной записки.
- Нумерация рисунков: «Рисунок 1 — Контекстная диаграмма A‑0», «Рисунок 2 — Декомпозиция A0».
- Ссылки на источники нормативов (ГОСТ, локальные документы) приводятся в разделе «Перечень использованных источников» основного отчёта.

---

## Связь с кодовой базой CURSA

- Потребитель опубликованных конфигураций — `backend/app/services/norm_control_checker.py`.
- Планируемые компоненты:
  - API: `backend/app/api/standards_routes.py`.
  - Сервис: `backend/app/services/standard_config_service.py`.
  - Хранилище по умолчанию: `backend/app/config/standards.json` (с перспективой миграции в БД).
