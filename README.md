# CURSA - Система нормоконтроля документов

CURSA представляет собой автоматизированную систему для проверки и исправления оформления документов согласно стандартам нормоконтроля.

## Реализованные улучшения

1. **Форматирование текста**:
   - Исправление абзацного отступа (1.25 см)
   - Выравнивание текста по ширине
   - Исправление шрифта и размера текста
   - Правильное форматирование межстрочных интервалов

2. **Форматирование таблиц**:
   - Выравнивание текста в ячейках
   - Правильное форматирование заголовков таблиц
   - Соблюдение отступов в тексте таблиц

3. **Поддержка формул**:
   - Выравнивание формул по центру
   - Правильное размещение номеров формул
   - Оформление формул в соответствии с требованиями

4. **Библиографические ссылки**:
   - Правильное форматирование ссылок в тексте
   - Исправление ошибок в оформлении ссылок
   - Автоматическое форматирование списка источников по ГОСТ 7.0.100-2018

5. **Оптимизация применения исправлений**:
   - Улучшенный порядок исправлений для более предсказуемого результата
   - Обработка ошибок и восстановление после них

6. **Форматирование списка литературы и оглавления**:
   - Правильное форматирование списка литературы
   - Автоматическое добавление нумерации в списке литературы
   - Исправление форматирования оглавления

7. **Списки и перечисления**:
   - Поддержка буквенных перечислений
   - Форматирование многоуровневых списков
   - Правильные отступы для элементов списков

8. **Приложения**:
   - Форматирование заголовков приложений
   - Правильная обработка содержимого приложений
   - Автоматическое выравнивание элементов в приложениях

9. **Акценты в тексте**:
   - Сохранение специального форматирования (курсив, жирность) для акцентов
   - Исправление несогласованного форматирования

10. **Подстрочные ссылки**:
    - Правильное форматирование сносок
    - Настройка шрифта и выравнивания для сносок

11. **Заголовки разделов**:
    - Улучшенное распознавание заголовков
    - Правильное форматирование заголовков разных уровней
    - Исправление регистра и удаление точек в заголовках

12. **Переносы слов**:
    - Автоматическая настройка переносов для русского текста
    - Исправление неправильных переносов
    - Запрет переносов для предлогов и специальных сокращений
    - Предотвращение "висячих" предлогов и союзов в конце строк

13. **Перекрестные ссылки**:
    - Унификация формата ссылок на рисунки, таблицы, формулы и разделы
    - Автоматическое исправление некорректных ссылок
    - Проверка соответствия ссылок и объектов ссылок

14. **Список сокращений и условных обозначений**:
    - Форматирование списка сокращений в соответствии с требованиями
    - Проверка наличия расшифровки сокращений при первом упоминании
    - Автоматическое добавление расшифровки при отсутствии

## Исправленные ошибки

- Исправлена ошибка импорта `WD_TABLE_ALIGNMENT` (перемещен из `docx.enum.text` в `docx.enum.table`)
- Добавлен импорт `Paragraph` для устранения ошибки "Paragraph is not defined"
- Улучшена обработка ошибок при работе с файлами

## Запуск приложения

### Windows

Для запуска приложения используйте скрипт `start_app.bat`.

### Linux/macOS

Для запуска приложения используйте скрипт `start_app.sh`.

## Основные функции

- Проверка документов на соответствие требованиям нормоконтроля
- Автоматическое исправление ошибок форматирования
- Генерация отчетов о выявленных ошибках
- Веб-интерфейс для загрузки и обработки документов

## Установка и запуск

### Для Windows

1. Убедитесь, что у вас установлены Python 3.8+ и Node.js
2. Запустите `start_app.bat`
3. Для создания ярлыка на рабочем столе запустите `create_shortcut.vbs`

### Для Linux/Mac

1. Убедитесь, что у вас установлены Python 3.8+ и Node.js
2. Запустите `bash start_app.sh`

## Требования

- Python 3.8 или выше
- Node.js 14 или выше
- Браузер с поддержкой HTML5

## Структура проекта

- `backend/` - Серверная часть приложения (Python/Flask)
- `frontend/` - Клиентская часть приложения (React)
- `start_app.bat` - Скрипт для запуска на Windows
- `start_app.sh` - Скрипт для запуска на Linux/Mac
- `create_shortcut.vbs` - Скрипт для создания ярлыка на рабочем столе

## Основные возможности

1. Загрузка документов в формате DOCX для проверки
2. Автоматическая проверка документов на соответствие требованиям форматирования:
   - Шрифт (тип, размер)
   - Поля страницы
   - Межстрочный интервал
   - Заголовки
   - Оформление списков, таблиц и рисунков
   - и другие параметры
3. Отображение найденных ошибок форматирования
4. Автоматическое исправление выявленных ошибок
5. Скачивание исправленных документов

## Структура проекта

- `backend/` - серверная часть приложения
  - `app/` - основной код приложения
    - `api/` - API маршруты
    - `services/` - сервисы для работы с документами
    - `models/` - модели данных
    - `static/` - статические файлы
    - `templates/` - шаблоны
  - `tests/` - тесты
    - `functional/` - функциональные тесты
    - `integration/` - интеграционные тесты
    - `unit/` - модульные тесты
    - `test_data/` - тестовые данные
      - `results/` - результаты тестов

## Тестирование

### Запуск тестов

Для запуска тестов выполните следующие команды:

```bash
# Перейдите в директорию backend
cd backend

# Запустите тестовый скрипт
python tests/run_tests.py
```

Для запуска тестов с подробным выводом:

```bash
python tests/run_tests.py -v
```

Для создания примера результатов тестирования и отчета:

```bash
python tests/run_tests.py -s
```

Для формирования отчета из существующих результатов:

```bash
python tests/run_tests.py -r
```

### Тестовые скрипты для Windows и Linux

В корневой директории backend также есть готовые скрипты для запуска тестов:

- **Windows**: `run_tests.bat`
- **Linux/Mac**: `run_tests.sh`

Эти скрипты предоставляют интерактивный способ запуска тестов и формирования отчетов.

### Отчеты о тестировании

После запуска тестов генерируется отчет, который содержит:

- Общую статистику по результатам тестирования
- Результаты тестов по категориям
- Подробный отчет по каждому тесту

Отчеты сохраняются в директории `backend/tests/test_data/results/`.

## Технические особенности

- Система использует библиотеку python-docx для работы с документами DOCX
- Backend реализован на Flask (Python)
- Для автоматического тестирования используется pytest

## Функциональность

- Загрузка курсовых работ в формате DOCX
- Детальная проверка документа на соответствие требованиям нормоконтроля
- Генерация подробного отчета о найденных несоответствиях
- Автоматическое исправление выявленных ошибок (где это возможно)
- Возможность скачать исправленную версию документа

## Проверяемые требования нормоконтроля

Система проверяет следующие аспекты оформления:

- **Шрифты и форматирование текста**
  - Название шрифта (Times New Roman)
  - Размер шрифта (14 пт для основного текста)
  - Согласованность форматирования

- **Поля документа**
  - Левое поле (3 см)
  - Правое поле (1.5 см)
  - Верхнее и нижнее поля (2 см)

- **Межстрочный интервал**
  - Соответствие стандарту (1.5)

- **Форматирование параграфов**
  - Отступ первой строки (1.25 см)
  - Выравнивание текста (по ширине)

- **Заголовки**
  - Форматирование (размер, стиль, прописные буквы)
  - Нумерация
  - Отступы до и после

- **Список литературы**
  - Оформление библиографических записей согласно ГОСТ
  - Различные типы источников (книги, статьи, электронные ресурсы и др.)

- **Таблицы и изображения**
  - Нумерация
  - Подписи
  - Ссылки в тексте

- **Нумерация страниц**
  - Наличие и расположение

- **Структура документа**
  - Наличие обязательных разделов

## Технологии

### Бэкенд
- Python
- Flask
- python-docx для работы с DOCX файлами
- docxtpl для создания и модификации шаблонов документов
- flask-cors для обработки CORS-запросов

### Фронтенд
- React
- Material-UI для компонентов и стилизации
- React Router для навигации
- Axios для API-запросов
- React Dropzone для загрузки файлов

## Планы по развитию

- Расширение функционала проверки документов
- Добавление возможности написания курсовой работы онлайн
- Улучшение алгоритмов автоматического исправления ошибок
- Добавление системы аутентификации пользователей
- Создание шаблонов типовых курсовых работ
- Реализация функции сохранения истории проверок

## Контакты

Если у вас есть вопросы или предложения по улучшению проекта, пожалуйста, создайте issue в репозитории или свяжитесь с разработчиками.

## Быстрый запуск приложения

### Windows
1. Дважды щелкните на файле `start_app.bat`
2. Если Python или Node.js не установлены, скрипт предложит установить их автоматически
3. Приложение автоматически запустится и откроется в браузере
4. Для остановки приложения закройте окно командной строки

### Linux/Mac
1. Откройте терминал в корневой директории проекта
2. Выполните команду: `chmod +x start_app.sh`
3. Запустите скрипт: `./start_app.sh`
4. Если Python или Node.js не установлены, скрипт предложит установить их автоматически
5. Приложение автоматически запустится и откроется в браузере
6. Для остановки приложения нажмите Ctrl+C в терминале

### Создание ярлыка на рабочем столе (Windows)

#### Автоматическое создание ярлыка
1. Дважды щелкните на файле `create_shortcut.vbs`
2. Ярлык автоматически создастся на рабочем столе

#### Создание ярлыка вручную
1. Щелкните правой кнопкой мыши на рабочем столе
2. Выберите "Создать" -> "Ярлык"
3. В поле "Расположение объекта" введите полный путь к файлу start_app.bat, например:
   `C:\Users\username\Documents\CURSA\start_app.bat`
4. Нажмите "Далее"
5. Введите имя ярлыка, например "CURSA - Система нормоконтроля"
6. Нажмите "Готово"

Теперь вы можете запускать приложение одним щелчком по ярлыку на рабочем столе.

### Системные требования

#### Минимальные требования
- Операционная система: Windows 10/11, macOS 10.15+, Linux (Ubuntu 20.04+, Fedora 34+, и др.)
- Процессор: 2 ядра, 2 ГГц
- Оперативная память: 4 ГБ
- Свободное место на диске: 1 ГБ
- Браузер: Chrome 90+, Firefox 90+, Edge 90+

#### Необходимое ПО
- Python 3.8 или выше (устанавливается автоматически при первом запуске)
- Node.js 16 или выше (устанавливается автоматически при первом запуске) 