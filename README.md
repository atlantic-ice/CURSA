# Система автоматизированного нормоконтроля документов

Данная система предназначена для автоматической проверки соответствия документов формата DOCX требованиям нормоконтроля.

## Основные возможности

1. Загрузка документов в формате DOCX для проверки
2. Автоматическая проверка документов на соответствие требованиям форматирования:
   - Шрифт (тип, размер)
   - Поля страницы
   - Межстрочный интервал
   - Заголовки
   - Оформление списков, таблиц и рисунков
   - и другие параметры
3. Отображение найденных ошибок форматирования
4. Автоматическое исправление выявленных ошибок
5. Скачивание исправленных документов

## Структура проекта

- `backend/` - серверная часть приложения
  - `app/` - основной код приложения
    - `api/` - API маршруты
    - `services/` - сервисы для работы с документами
    - `models/` - модели данных
    - `static/` - статические файлы
    - `templates/` - шаблоны
  - `tests/` - тесты
    - `functional/` - функциональные тесты
    - `integration/` - интеграционные тесты
    - `unit/` - модульные тесты
    - `test_data/` - тестовые данные
      - `results/` - результаты тестов

## Тестирование

### Запуск тестов

Для запуска тестов выполните следующие команды:

```bash
# Перейдите в директорию backend
cd backend

# Запустите тестовый скрипт
python tests/run_tests.py
```

Для запуска тестов с подробным выводом:

```bash
python tests/run_tests.py -v
```

Для создания примера результатов тестирования и отчета:

```bash
python tests/run_tests.py -s
```

Для формирования отчета из существующих результатов:

```bash
python tests/run_tests.py -r
```

### Тестовые скрипты для Windows и Linux

В корневой директории backend также есть готовые скрипты для запуска тестов:

- **Windows**: `run_tests.bat`
- **Linux/Mac**: `run_tests.sh`

Эти скрипты предоставляют интерактивный способ запуска тестов и формирования отчетов.

### Отчеты о тестировании

После запуска тестов генерируется отчет, который содержит:

- Общую статистику по результатам тестирования
- Результаты тестов по категориям
- Подробный отчет по каждому тесту

Отчеты сохраняются в директории `backend/tests/test_data/results/`.

## Требования

- Python 3.7+
- python-docx
- Flask
- pytest

## Установка и запуск

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск сервера
cd backend
python app.py
```

## Тестовые данные

Для тестирования системы предусмотрен генератор тестовых документов, который создает DOCX файлы с различными ошибками форматирования:

```bash
cd backend
python tests/test_data_generator.py
```

Для создания всех тестовых документов сразу:

```bash
python tests/test_data_generator.py -a
```

## Проверяемые требования

Тестовый модуль проверяет следующие функциональные требования:

1. Возможность загрузки DOCX-документов
2. Корректность автоматической проверки форматирования:
   - Шрифт (Times New Roman, 14pt)
   - Поля страницы (левое 3 см, правое 1.5 см, верхнее и нижнее 2 см)
   - Межстрочный интервал (1.5)
3. Выявление и отображение ошибок форматирования
4. Автоматическое исправление ошибок
5. Скачивание исправленных документов
6. Производительность при обработке больших документов

## Технические особенности

- Система использует библиотеку python-docx для работы с документами DOCX
- Backend реализован на Flask (Python)
- Для автоматического тестирования используется pytest

## Функциональность

- Загрузка курсовых работ в формате DOCX
- Детальная проверка документа на соответствие требованиям нормоконтроля
- Генерация подробного отчета о найденных несоответствиях
- Автоматическое исправление выявленных ошибок (где это возможно)
- Возможность скачать исправленную версию документа

## Проверяемые требования нормоконтроля

Система проверяет следующие аспекты оформления:

- **Шрифты и форматирование текста**
  - Название шрифта (Times New Roman)
  - Размер шрифта (14 пт для основного текста)
  - Согласованность форматирования

- **Поля документа**
  - Левое поле (3 см)
  - Правое поле (1.5 см)
  - Верхнее и нижнее поля (2 см)

- **Межстрочный интервал**
  - Соответствие стандарту (1.5)

- **Форматирование параграфов**
  - Отступ первой строки (1.25 см)
  - Выравнивание текста (по ширине)

- **Заголовки**
  - Форматирование (размер, стиль, прописные буквы)
  - Нумерация
  - Отступы до и после

- **Список литературы**
  - Оформление библиографических записей согласно ГОСТ
  - Различные типы источников (книги, статьи, электронные ресурсы и др.)

- **Таблицы и изображения**
  - Нумерация
  - Подписи
  - Ссылки в тексте

- **Нумерация страниц**
  - Наличие и расположение

- **Структура документа**
  - Наличие обязательных разделов

## Технологии

### Бэкенд
- Python
- Flask
- python-docx для работы с DOCX файлами
- docxtpl для создания и модификации шаблонов документов
- flask-cors для обработки CORS-запросов

### Фронтенд
- React
- Material-UI для компонентов и стилизации
- React Router для навигации
- Axios для API-запросов
- React Dropzone для загрузки файлов

## Установка и запуск

### Бэкенд

1. Перейдите в директорию бэкенда:
   ```
   cd backend
   ```

2. Создайте виртуальное окружение:
   ```
   python -m venv venv
   ```

3. Активируйте виртуальное окружение:
   - Windows:
     ```
     venv\Scripts\activate
     ```
   - macOS и Linux:
     ```
     source venv/bin/activate
     ```

4. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

5. Запустите сервер:
   ```
   python run.py
   ```
   
   Сервер будет запущен по адресу http://localhost:5000

### Фронтенд

1. Перейдите в директорию фронтенда:
   ```
   cd frontend
   ```

2. Установите зависимости:
   ```
   npm install
   ```

3. Запустите приложение:
   ```
   npm start
   ```
   
   Приложение будет доступно по адресу http://localhost:3000

## Структура проекта

```
CURSA/
├── backend/
│   ├── app/
│   │   ├── api/
│   │   │   └── document_routes.py
│   │   ├── models/
│   │   ├── services/
│   │   │   ├── document_processor.py
│   │   │   ├── norm_control_checker.py
│   │   │   └── document_corrector.py
│   │   ├── static/
│   │   │   └── corrections/
│   │   ├── templates/
│   │   └── __init__.py
│   ├── corrections/
│   │   └── norm_control_requirements.txt
│   ├── run.py
│   └── requirements.txt
├── frontend/
│   ├── public/
│   └── src/
│       ├── components/
│       │   ├── FAQSection.js
│       │   ├── Footer.js
│       │   ├── GuidelineExample.js
│       │   ├── Header.js
│       │   ├── NotificationsPanel.js
│       │   ├── RelatedLinksCard.js
│       │   ├── RequirementsSummary.js
│       │   ├── StructureAnalysisCard.js
│       │   └── TemplatesSection.js
│       ├── pages/
│       │   ├── AdminPage.js
│       │   ├── CheckPage.js
│       │   ├── ExamplesPage.js
│       │   ├── GuidelinesPage.js
│       │   ├── HistoryPage.js
│       │   ├── HomePage.js
│       │   ├── ReportPage.js
│       │   └── ResourcesPage.js
│       ├── App.css
│       ├── App.js
│       ├── index.css
│       └── index.js
└── README.md
```

## Планы по развитию

- Расширение функционала проверки документов
- Добавление возможности написания курсовой работы онлайн
- Улучшение алгоритмов автоматического исправления ошибок
- Добавление системы аутентификации пользователей
- Создание шаблонов типовых курсовых работ
- Реализация функции сохранения истории проверок

## Контакты

Если у вас есть вопросы или предложения по улучшению проекта, пожалуйста, создайте issue в репозитории или свяжитесь с разработчиками. 